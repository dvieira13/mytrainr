import{d as Q,b as X,t as D,e as b,r as M,i as W,n as A}from"./main-svh6Mj5L.js";const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function Y(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}let U;const Z=new Uint8Array(16);function ee(){if(!U){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");U=crypto.getRandomValues.bind(crypto)}return U(Z)}const te=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),O={randomUUID:te};function ne(e,t,o){var a;if(O.randomUUID&&!e)return O.randomUUID();e=e||{};const n=e.random??((a=e.rng)==null?void 0:a.call(e))??ee();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Y(n)}const oe=document.querySelector("#generator_submit_button"),y=sessionStorage.getItem("user_id"),ae=document.querySelector("#duplicate_event_popup"),se=document.querySelector("#generator_submit_confirm_button"),re=document.querySelector("#popup_event_name"),ce=document.querySelectorAll(".close-popup"),ie=document.querySelector("#account_event_popup"),ue=document.querySelector("#generator_sign_in_button"),le=document.querySelector("#generator_create_account_button"),de=document.querySelector("#generator_force_submit_button"),k=document.querySelector("#event_name"),S=document.querySelector("#event_distance"),w=document.querySelector("#event_date"),p=document.querySelector("#event_goal_time"),d=document.querySelector("#event_goal_pace"),E=document.querySelector("#athlete_weeks_to_train"),T=document.querySelector("#athlete_experience"),C=document.querySelectorAll(".day");me();function me(){oe.addEventListener("click",function(){if(P("generator_form")==!0&&y)if(Q(y)==!0){const e=X(y);e&&(re.innerHTML=e),D(ae,"trainr-popup-active")}else{const e=b();x(e,y,k.value,w.value,S.value,L(),E.value,T.value,q()),M()}else P("generator_form")==!0&&!y&&D(ie,"trainr-popup-active")}),se.addEventListener("click",function(){if(y){const e=b();x(e,y,k.value,w.value,S.value,L(),E.value,T.value,q()),M()}}),ce.forEach(e=>{e.addEventListener("click",t=>{const n=t.currentTarget.closest(".trainr-popup-container");n&&n.classList.remove("trainr-popup-active")})}),d.addEventListener("input",function(){p.value=""}),p.addEventListener("input",function(){d.value=""}),C.forEach(e=>{e.addEventListener("click",t=>{const o=t.target;D(o,"day-selected")})}),ue.addEventListener("click",function(){const e=b();x(e,"",k.value,w.value,S.value,L(),E.value,T.value,q()),sessionStorage.setItem("event_id_to_associate",e),window.location.href="/sign-in?associate-event"}),le.addEventListener("click",function(){const e=b();x(e,"",k.value,w.value,S.value,L(),E.value,T.value,q()),sessionStorage.setItem("event_id_to_associate",e),window.location.href="/create-account?associate-event"}),de.addEventListener("click",function(){const e=b();x(e,"",k.value,w.value,S.value,L(),E.value,T.value,q()),sessionStorage.setItem("event_id_to_associate",e),M()})}function P(e){var a,c,r,i;let t=!0;return _e(e),!p.value&&!d.value||p.value&&W(p.value)===!1&&!d.value?((a=p.closest(".form-item"))==null||a.classList.add("form-item-error"),t=!1):(c=p.closest(".form-item"))==null||c.classList.remove("form-item-error"),d.value&&W(d.value)===!1&&!p.value?((r=d.closest(".form-item"))==null||r.classList.add("form-item-error"),t=!1):(i=d.closest(".form-item"))==null||i.classList.remove("form-item-error"),document.querySelectorAll("#"+e+" input").forEach(s=>{var u;(s.value==null||s.value=="")&&(s.id.includes("event_goal_pace")||s.id.includes("event_goal_time")||((u=s.closest(".form-item"))==null||u.classList.add("form-item-error"),t=!1))}),document.querySelectorAll("#"+e+" select").forEach(s=>{var u;(s.value==null||s.value=="")&&((u=s.closest(".form-item"))==null||u.classList.add("form-item-error"),t=!1)}),t}function _e(e){document.querySelectorAll("#"+e+" input").forEach(n=>{var a;(a=n.closest(".form-item"))==null||a.classList.remove("form-item-error")}),document.querySelectorAll("#"+e+" select").forEach(n=>{var a;(a=n.closest(".form-item"))==null||a.classList.remove("form-item-error")})}function x(e,t,o,n,a,c,r,i,s){const u=he({event_id:e,event_distance:a,event_goal_time:A(c),athlete_weeks_to_train:Number(r),athlete_experience:i,athlete_days_to_train:s});console.log(u);const m={event_id:e,user_id:t,event_name:o,event_date:n,event_distance:a,event_goal_time:A(c),athlete_weeks_to_train:Number(r),athlete_experience:i,days_to_train:s,workout_plan:u};ve(m)}function ve(e){const t=localStorage.getItem("trainr_events");let o=t?JSON.parse(t):[];const n=o.findIndex(a=>a.user_id===e.user_id);n!==-1?o[n]=e:o.push(e),localStorage.setItem("trainr_events",JSON.stringify(o))}function L(){let e="";return d.value?e=pe(d.value,S.value):e=p.value,e}function pe(e,t){const[o,n]=e.split(":").map(Number),a=parseFloat(t);if(isNaN(o)||isNaN(n)||isNaN(a)||a<=0)return"Invalid input";const c=o*60+n,r=Math.round(c*a),i=Math.floor(r/3600),s=Math.floor(r%3600/60),u=r%60,m=I=>I.toString().padStart(2,"0");return`${m(i)}:${m(s)}:${m(u)}`}function q(){let e=[];return C.forEach(t=>{var o;if(t.classList.contains("day-selected")){const n=(o=t.querySelector(".caption-copy"))==null?void 0:o.innerHTML;n&&e.push(n)}}),e.length==0&&(e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),fe(e)}function fe(e){const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return e.filter(o=>t.includes(o))}const f=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function ye(e){const[t,o,n]=e.split(":").map(Number);return t*3600+o*60+n}function ge(e){const t=Math.floor(e/60),o=Math.round(e%60);return`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}function Se(e,t=5){const o=f.filter(c=>e.includes(c)),n=[],a=(c,r)=>{if(c.length===t){n.push(c);return}for(let i=0;i<r.length;i++)a([...c,r[i]],r.slice(i+1))};a([],o);for(const c of n){const r=new Set(c);let i=!1;for(let s=0;s<f.length-1;s++){const u=!r.has(f[s]),m=!r.has(f[s+1]);if(u&&m){i=!0;break}}if(!i)return c.sort((s,u)=>f.indexOf(s)-f.indexOf(u))}return o.slice(0,t)}function he(e){const{event_id:t,event_distance:o,event_goal_time:n,athlete_weeks_to_train:a,athlete_experience:c,athlete_days_to_train:r}=e,i=parseFloat(o),u=ye(n)/i,m={"easy run":u*1.1,"tempo run":u*.95,"long run":u,"rest day":0},I={Beginner:1,Intermediate:1.2,Experienced:1.5}[c],H=i/(a*5)*10,V=Math.max(a-2,1),N=[];for(let h=0;h<a;h++){const $=h<V?.8+h/a*1:.6+h/a*.1,g=Se(r,5),R=["Sunday","Saturday"].find(_=>g.includes(_))??g[g.length-1],G=f.indexOf(R),z=g.find(_=>Math.abs(f.indexOf(_)-G)>1)??g[0],F=[];for(const _ of f){let v;!r.includes(_)||!g.includes(_)?v="rest day":_===z?v="tempo run":_===R?v="long run":v="easy run";const B={"easy run":1,"tempo run":1.5,"long run":2.5,"rest day":0}[v],J={"3.1":3,"6.2":1.8,"13.1":1.2,"26.2":1}[o]??1,j=H*B*$*I*J,K={workout_id:ne(),event_id:t,workout_distance:v==="rest day"?0:parseInt(j.toFixed(1)),workout_type:v,workout_difficulty:void 0,workout_day:_,workout_target_pace:v==="rest day"?void 0:ge(m[v]),workout_complete:!1,workout_time:void 0,workout_notes:void 0};F.push(K)}N.push(F)}return N}
