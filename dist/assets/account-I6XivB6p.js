import{l as J,d as H,b as R,t as B,m as p,r as S,o as m,u as C,p as D,e as F}from"./main-CPDM8zUK.js";let o;const r=document.querySelector(".account-form"),y=document.querySelector(".account-form-cta"),f="sign_in_form",d="create_account_form",c=document.querySelector("#username"),a=document.querySelector("#password");let L,w,v;const z=document.querySelector("#duplicate_event_popup"),G=document.querySelector("#associator_replace_event_button"),j=document.querySelector("#associator_force_submit_button"),K=document.querySelector("#popup_event_name"),P=document.querySelector("#popup_new_event_name"),Q=document.querySelector(".close-popup"),V=document.querySelector(".associate-message"),W=document.querySelector("#associate_message_name");X();function X(){const t=sessionStorage.getItem("event_id_to_associate");if(t){V.classList.remove("hide-associate-message");const e=J(t);e&&(W.innerHTML=e)}r&&r.id==d&&(L=document.querySelector("#first_name"),w=document.querySelector("#last_name"),v=document.querySelector("#confirm_password")),y==null||y.addEventListener("click",function(){if(t)if(r&&r.id==f&&g(f)==!0)if(H(o)==!0){const e=R(o);e&&(K.innerHTML=e);const s=J(t);s&&(P.innerHTML=s),B(z,"trainr-popup-active")}else _(o),p("event_id_to_associate"),window.location.href.includes("associate-event")?S():m();else r&&r.id==d&&g(d)==!0&&(O(L.value,w.value,c.value,a.value),C(t,o),_(o),p("event_id_to_associate"),window.location.href.includes("associate-event")?S():m());else r&&r.id==f&&g(f)==!0?(_(o),m()):r&&r.id==d&&g(d)==!0&&(O(L.value,w.value,c.value,a.value),_(o),m())}),Q.addEventListener("click",function(){const e=this.closest(".trainr-popup-container");e&&e.classList.remove("trainr-popup-active")}),G.addEventListener("click",function(){t&&(D(t,o),_(o),p("event_id_to_associate"),window.location.href.includes("associate-event")?S():m())}),j.addEventListener("click",function(){t&&(_(o),p("event_id_to_associate"),window.location.href.includes("associate-event")?S():m())})}function g(t){var u,n,l,q,I,h,E,U,x,N,T;let e=!0;if(document.querySelectorAll(".account-form input").forEach(i=>{var M,b,k;i.value==null||i.value==""?((M=i.closest(".account-form-item"))==null||M.classList.add("form-item-error"),e=!1):(b=i.closest(".account-form-item"))!=null&&b.classList.contains("form-item-error")&&((k=i.closest(".account-form-item"))==null||k.classList.remove("form-item-error"))}),t===f){if(c.value&&a.value){const i=Z(c.value,a.value);i==null?((u=document.querySelector("#error_no_account_exists"))==null||u.classList.add("error-active"),e=!1):o=i}}else t===d&&(a.value!=v.value?((n=document.querySelector("#error_password_match"))==null||n.classList.add("error-active"),(l=a.closest(".account-form-item"))==null||l.classList.add("form-item-error"),(q=v.closest(".account-form-item"))==null||q.classList.add("form-item-error"),e=!1):a.value&&a.value===v.value&&((I=document.querySelector("#error_password_match"))==null||I.classList.remove("error-active"),(h=a.closest(".account-form-item"))==null||h.classList.remove("form-item-error"),(E=v.closest(".account-form-item"))==null||E.classList.remove("form-item-error")),c.value&&A(c.value)==!0?((U=document.querySelector("#error_account_exists"))==null||U.classList.add("error-active"),(x=c.closest(".account-form-item"))==null||x.classList.add("form-item-error"),e=!1):c.value&&A(c.value)==!1&&((N=document.querySelector("#error_account_exists"))==null||N.classList.remove("error-active"),(T=c.closest(".account-form-item"))==null||T.classList.remove("form-item-error")));return e}function O(t,e,s,u){const n=F();o=n,Y({user_id:n,user_first_name:t,user_last_name:e,user_username:s,user_password:u,user_total_miles:0,user_total_time:"0:00",user_total_workouts:0})}function Y(t){const e=localStorage.getItem("trainr_users"),s=e?JSON.parse(e):[];s.push(t),localStorage.setItem("trainr_users",JSON.stringify(s))}function _(t){sessionStorage.setItem("user_id",t)}function A(t){const e=localStorage.getItem("trainr_users");return e?JSON.parse(e).some(u=>u.user_username===t):!1}function Z(t,e){const s=localStorage.getItem("trainr_users");if(!s)return null;const n=JSON.parse(s).find(l=>l.user_username===t&&l.user_password===e);return n?n.user_id:null}
